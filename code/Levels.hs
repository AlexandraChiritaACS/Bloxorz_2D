module Levels (
    Game(..),
    createLevel,
    maps
) where

-------------
--LIBRARIES--
-------------
import Map
import Block
import Data.List
import Data.Maybe
import Graphics.UI.WXCore

-------------------
--TYPE DEFINITION--
-------------------
data Game = Game {
    level :: Level,
    piece :: Piece,
    nColumns :: Int,
    nRows :: Int,
    nLevel :: Int
} deriving Show

-----------
--METHODS--
-----------
createLevel :: Int -> Game
createLevel nLvl = game
    where
        map = (maps !! nLvl)
        columns = length map
        rows = length (map !! 0)
        initialPos = elemIndex 'S' (concat map)
        endingPos = elemIndex 'G'  (concat map)
        theMap = createTheMap map (fromJust initialPos) (fromJust endingPos) rows --CAUTION: 'x' and 'y' are reversed
        theBlock = createThePiece (fromJust initialPos) rows --CAUTION: 'x' and 'y' are reversed
        game = Game {level = theMap, piece = theBlock, nColumns = columns, nRows = rows, nLevel = nLvl}

--MAPS
maps = [
        --LEVEL_0
        ["1110000000",
         "1S11110000",
         "1111111110",
         "0111111111",
         "0000011G11",
         "0000001110"],
        --LEVEL_1
        ["0001111110000000",
        "0001S11111110000",
        "0001111111111110",
        "0000111110011111",
        "0000111110001111",
        "0000110011101111",
        "0000110011110111",
        "0000011G11111000"],
        --LEVEL_2
        ["000000000G11111000000000",
        "000011110000011111100000",
        "000011S11111001101100000",
        "000011111000001111110000",
        "111111111110001111110000",
        "111111100000001111000000",
        "111110000000001111000000",
        "111100001100001111100000",
        "111110011110001111100000",
        "111000111111001111111000",
        "111001111111100111111100",
        "111111110011111111110000"],
        --LEVEL_3
        ["0001111110000000",
        "0001S11211110000",
        "0001111111111110",
        "0000111110011111",
        "0000121110001111",
        "0000110022201111",
        "0000110022210111",
        "0000011G11111000"],
        --LEVEL_4
        ["11111111101111111",
        "11S11111101111111",
        "11111111101111111",
        "11111111101111111",
        "11111X11101111111",
        "11111111101111111",
        "111111111x1111G11",
        "11111111101111111"],
        --LEVEL_5
        ["111111111011111110011111110001111",
        "11S11111101111122ff11111110001111",
        "111111111011111110011111110001111",
        "111111111011111110011111110001111",
        "11111X1110111111100111T112ttt1111",
        "11111111101111111001111111ttt1111",
        "111111111x1111F110011111110001112",
        "00000000101111111001111111000112G"],
        --LEVEL_6
        ["000000111100111",
        "11110011H1001G1",
        "11X100111100111",
        "111100111100111",
        "1S11xx1111hh111",
        "111100111100000"],
        --LEVEL_7
        ["000000111111100",
        "111100111001100",
        "111111111001111",
        "1S11000000011G1",
        "111100000001111",
        "000000000000111"],
        --LEVEL_8
        ["00022222220000",
        "00022222220000",
        "11110000011100",
        "11100000001100",
        "11100000001100",
        "1S100111122222",
        "11100111122222",
        "000001G1002212",
        "00000111002222"],
        --LEVEL_9
        ["00000000001111",
        "1111xx1X1111S1",
        "11110000000111",
        "11110000000000",
        "11110000000000",
        "00111H1hh11100",
        "0000000001111Z",
        "11100000011111",
        "1G111zz1111100",
        "11110000000000"],
        --LEVEL_10
        ["000001111110000",
        "000001001110000",
        "000001001111100",
        "S11111000001111",
        "0000111000011G1",
        "000011100000111",
        "000000100110000",
        "000000111110000",
        "000000111110000",
        "000000011100000"],
        --LEVEL_11
        ["000000000011111000",
        "031110000011G11000",
        "01S110131000111100",
        "011100111100c00000",
        "01000X114C10c11100",
        "011000000000011104",
        "0111001xxxxxx11101",
        "011111110000111111"],
        --LEVEL_12
        ["000111111110000000",
        "0001S1131111110000",
        "000111114111111110",
        "000011511001111111",
        "000011111000111114",
        "000011001110111111",
        "000011001111011111",
        "0000011G1151100013"],
        --LEVEL_13
        ["000000000000X",
        "0000011100111",
        "000001Z11111z",
        "0001111100110",
        "0001G1x000110",
        "0111110001111",
        "11S1000001111",
        "1111001111100",
        "0000011100000",
        "0000011100000"],
        --LEVEL_14
        ["11121111211110",
        "11000000001110",
        "11000000000111",
        "111000111001S1",
        "1112221G100111",
        "11100211100100",
        "00100222221100",
        "00111221222000",
        "00011222222000",
        "00011100110000"],
        --LEVEL_15
        ["000000001111000",
        "000000001111000",
        "111000001001111",
        "1111111110001G1",
        "1S1000011X00111",
        "111000011100111",
        "011x00010000000",
        "001111110000000"],
        --LEVEL_16
        ["00000001010000000000000000000000",
        "00000011110000000000000000000000",
        "00011110110000000000000000000000",
        "000111S1110000000000000000000000",
        "00000001211000000000000000000000",
        "00000000111100000000000000000000",
        "11100000012100000000000000000000",
        "14110000011110000000000000000000",
        "11110000001110000000000000000000",
        "22211000001121000000000000000000",
        "11110000000111000000000000000000",
        "1G100000000111100000000000000000",
        "00000000000121100000000000000000",
        "00000000000111111111111211000000",
        "00000000000112111211211121100000",
        "0000000000011121112111211111xx00",
        "00000000000012111121121121100100",
        "00000000000001111211112111100100",
        "00000000000001100000000001100410",
        "00000000000003100000000001100000",
        "00000000000001100000000001100001",
        "00000000000001100000000001100011",
        "00000000000001100000000001100X11",
        "00000000000011100000000011101113"],
        --LEVEL_17
        ["00000000000000000000000000000000000000000000000000000000",
        "00000000000000000000000111000000000000000000000000000000",
        "00000000000000000000001Z11100000000000000000031140000000",
        "00000000000000000000001111000000000000000000011110000000",
        "00000000000000000000011100000000000000000000011110000000",
        "000000000000000000002222000000000000000000000511X0000000",
        "00000000000000000000022000000000000000000000000000000000",
        "00000000000000000000022000000000000000000000000000000000",
        "00011100000000000011111111111111110000000000000000000000",
        "001111G000000000xxxxxxxxxxxxxxxxxxxx00000000000000000000",
        "00111110000000111111111111111111111111000000000000000000",
        "00011100000011111211112211111111111121110000000000000000",
        "00001000000011111111110000011111111111110000000000000000",
        "0000z010000011200211110111011111200221110000000000000000",
        "00001110000011200211110111011111200222210000000000000000",
        "0000500000001111111111031S011122224222110000000000000000"],
        --LEVEL_18
        ["1151111000000000000000000000000000000000000000000000",
        "2201010110000000000000000000000000000000000000000000",
        "01G1122620000000022222222222222220000000000000000000",
        "11111222200000000112211122S1122110000000000000000000",
        "1111111110000222222222222222222222222000000000000000",
        "0000000000000111221112211122111122111000000000000000",
        "0000000000000022211111111111100111110000000000000000",
        "0000000000002221151100111111100111112200000000000000",
        "0000000000002221111000111111111111112222000000000000",
        "0000000000000022111100111111111100111500000000000000",
        "0000000000000011111111111111111100000000000000000000",
        "0000000000000000111111111111111111111100000000000000",
        "0000000000000000001111111111111111000000000000000000",
        "0000000000000000001111111111111111000000000000000000",
        "0000000000000001111221111111122111000000000000000000",
        "0000000000000111111221111111122111111000000000000000",
        "0000000000011111111221115111122111111110000000001000",
        "0000000001111111111221111111122111111111100000010000",
        "0000000011111111111221111111122111111111110001131100",
        "0000002222211111111222222222222111111112222201111100",
        "0000000242211111111222X2222Z222111111112222001161100",
        "0000000002211111111222222222222111111112200001111100",
        "0000000000011111111222222222222111111110000000000000",
        "0000000000011111111222222222222111111110000000000000",
        "0000000000022222222220000000022222222220000000000000",
        "0000000000022222222220000000022222222220000000000000",
        "000000000xxxxxxxxxx000000000000zzzzzzzzzz00000000000",
        "00000zzzzzzzzzzzzzz000000000000xxxxxxxxxxxxxx0000000",
        "0000031111111111111000000000000111111111111140000000",
        "0000000000000000000000000000000000000000000000000000"]
       ]